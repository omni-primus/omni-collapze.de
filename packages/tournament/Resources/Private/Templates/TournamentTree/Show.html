<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers" data-namespace-typo3-fluid="true">
<f:layout name="Default" />
<f:section name="content">
    <h1>OMNI Oktagon</h1>
    <ul>
        <li>{tournamentArray.tournament.tournament_type}</li>
        <f:variable name="matchesCount"><f:count subject="{matchesArray}"></f:count></f:variable>
        <li>Matches: {matchesCount}</li>
        <f:for each="{matchesArray}" as="match" iteration="i">
            <f:if condition="{i.cycle} == {matchesCount}">
                <f:variable name="rounds">{match.match.round}</f:variable>
            </f:if>
        </f:for>
        <li>Rounds: {rounds}</li>
        <f:debug>{matchesArray}</f:debug>
    </ul>

    <div class="container">
        <div class="tournament-bracket tournament-bracket--rounded">
            <div class="tournament-bracket__round tournament-bracket__round--quarterfinals">
                <h3 class="tournament-bracket__round-title">Quarterfinals</h3>
                <ul class="tournament-bracket__list">
                    <f:render section="bracket_match" arguments="{match: matchesArray.0.match}"/>
                    <f:render section="bracket_match" arguments="{match: matchesArray.1.match}"/>
                    <f:render section="bracket_match" arguments="{match: matchesArray.2.match}"/>
                    <f:render section="bracket_match" arguments="{match: matchesArray.3.match}"/>
                </ul>
            </div>
            <div class="tournament-bracket__round tournament-bracket__round--semifinals">
                <h3 class="tournament-bracket__round-title">Semifinals</h3>
                <ul class="tournament-bracket__list">
                    <f:render section="bracket_match" arguments="{match: matchesArray.4.match}"/>
                    <f:render section="bracket_match" arguments="{match: matchesArray.5.match}"/>
                </ul>
            </div>
            <div class="tournament-bracket__round tournament-bracket__round--gold">
                <h3 class="tournament-bracket__round-title">Final</h3>
                <ul class="tournament-bracket__list">
                    <f:render section="bracket_match" arguments="{match: matchesArray.6.match}"/>
                </ul>
            </div>
        </div>
    </div>

    <f:flashMessages />

    <table class="tx_tournament">
        <tr>
            <th></th>
            <th></th>
        </tr>
    </table>
</f:section>
<f:section name="bracket_match">
    <li class="tournament-bracket__item">
        <div class="tournament-bracket__match" tabindex="0">
            <table class="tournament-bracket__table">
                <thead class="sr-only">
                <tr>
                    <th>Player</th>
                    <th>Score</th>
                </tr>
                </thead>
                <tbody class="tournament-bracket__content">
                <f:if condition="{match.player1_id} == {match.winner_id}">
                    <f:variable name="winner1">winner1</f:variable>
                </f:if>
                <f:if condition="{match.player2_id} == {match.winner_id}">
                    <f:variable name="winner2">winner2</f:variable>
                </f:if>
                <tr class="tournament-bracket__team {f:if(condition: winner1, then: 'tournament-bracket__team--winner')}">
                    <td class="tournament-bracket__country">
                        <span class="tournament-bracket__code">{match.player1_id}</span>
                    </td>
                    <td class="tournament-bracket__score">
                        <span class="tournament-bracket__number">{match.scorePlayer1}</span>
                    </td>
                </tr>
                <tr class="tournament-bracket__team {f:if(condition: winner2, then: 'tournament-bracket__team--winner')}">
                    <td class="tournament-bracket__country">
                        <span class="tournament-bracket__code">{match.player2_id}</span>
                    </td>
                    <td class="tournament-bracket__score">
                        <span class="tournament-bracket__number">{match.scorePlayer2}</span>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </li>
</f:section>
</html>
